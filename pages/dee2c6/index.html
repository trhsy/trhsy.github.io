<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>s3 备份记录 | Sim-U我的世界模拟城市模组官网</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/img/favicon.ico">
    <script src="https://hm.baidu.com/hm.js?817347a1432d9478162aefb1f4c35e3f"></script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9156454987799969" crossorigin="anonymous"></script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9156454987799969" crossorigin="anonymous"></script>
    <meta name="description" content="由Trhsy重制的MC我的世界游戏模组模拟城市(sim-u)，也叫模拟大都市">
    <meta name="keywords" content="MC,我的世界,模拟城市,模拟城市模组,模拟大都市,模拟大都市模组,模拟大都市模组下载">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.e62da15a.css" as="style"><link rel="preload" href="/assets/js/app.31fb423f.js" as="script"><link rel="preload" href="/assets/js/2.bbf0c30b.js" as="script"><link rel="preload" href="/assets/js/20.9148d42d.js" as="script"><link rel="prefetch" href="/assets/js/10.1cfc5f1f.js"><link rel="prefetch" href="/assets/js/11.c132162d.js"><link rel="prefetch" href="/assets/js/12.abccc77c.js"><link rel="prefetch" href="/assets/js/13.6026bc8d.js"><link rel="prefetch" href="/assets/js/14.43f53bbe.js"><link rel="prefetch" href="/assets/js/15.5903c14d.js"><link rel="prefetch" href="/assets/js/16.660b2dae.js"><link rel="prefetch" href="/assets/js/17.4f8b47d7.js"><link rel="prefetch" href="/assets/js/18.d2f0bd87.js"><link rel="prefetch" href="/assets/js/19.7dd1aab2.js"><link rel="prefetch" href="/assets/js/21.4f8b33a5.js"><link rel="prefetch" href="/assets/js/22.ea8dd878.js"><link rel="prefetch" href="/assets/js/23.49532f94.js"><link rel="prefetch" href="/assets/js/24.4410f7e6.js"><link rel="prefetch" href="/assets/js/25.1cea1ca4.js"><link rel="prefetch" href="/assets/js/26.d5c27f52.js"><link rel="prefetch" href="/assets/js/27.80af4f97.js"><link rel="prefetch" href="/assets/js/28.d603c8c8.js"><link rel="prefetch" href="/assets/js/29.0472003d.js"><link rel="prefetch" href="/assets/js/3.740f3ccb.js"><link rel="prefetch" href="/assets/js/30.e9433941.js"><link rel="prefetch" href="/assets/js/31.33ab8b15.js"><link rel="prefetch" href="/assets/js/32.a51343f3.js"><link rel="prefetch" href="/assets/js/33.de946b81.js"><link rel="prefetch" href="/assets/js/34.eb7fc33a.js"><link rel="prefetch" href="/assets/js/4.983048ef.js"><link rel="prefetch" href="/assets/js/5.026a1258.js"><link rel="prefetch" href="/assets/js/6.4e495c6e.js"><link rel="prefetch" href="/assets/js/7.bb2e262c.js"><link rel="prefetch" href="/assets/js/8.0aae4450.js"><link rel="prefetch" href="/assets/js/9.30511a76.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e62da15a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Sim-U我的世界模拟城市模组官网" class="logo"> <span class="site-name can-hide">Sim-U我的世界模拟城市模组官网</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/posts/" class="nav-link">随笔</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><a href="/course/" class="link-title">教程</a> <span class="title" style="display:none;">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.bilibili.com/video/BV1jY411j7xZ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/course/1/" class="nav-link">使用教程</a></li><li class="dropdown-subitem"><a href="/course/2/" class="nav-link">常见问题</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/download/1/" class="nav-link">下载中心</a></div><div class="nav-item"><a href="/pages/1b12ed/" class="nav-link">赞助</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系我们" class="dropdown-title"><a href="/contact_us/1/" class="link-title">联系我们</a> <span class="title" style="display:none;">联系我们</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://qun.qq.com/qqweb/qunpro/share?_wv=3&amp;_wwv=128&amp;appChannel=share&amp;inviteCode=1W9y5py&amp;businessType=9&amp;from=246610&amp;biz=ka" target="_blank" rel="noopener noreferrer" class="nav-link external">
  官方频道
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/posts/" class="nav-link">随笔</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><a href="/course/" class="link-title">教程</a> <span class="title" style="display:none;">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.bilibili.com/video/BV1jY411j7xZ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  视频教程
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/course/1/" class="nav-link">使用教程</a></li><li class="dropdown-subitem"><a href="/course/2/" class="nav-link">常见问题</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/download/1/" class="nav-link">下载中心</a></div><div class="nav-item"><a href="/pages/1b12ed/" class="nav-link">赞助</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系我们" class="dropdown-title"><a href="/contact_us/1/" class="link-title">联系我们</a> <span class="title" style="display:none;">联系我们</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://qun.qq.com/qqweb/qunpro/share?_wv=3&amp;_wwv=128&amp;appChannel=share&amp;inviteCode=1W9y5py&amp;businessType=9&amp;from=246610&amp;biz=ka" target="_blank" rel="noopener noreferrer" class="nav-link external">
  官方频道
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav> <div class="sidebar-slot sidebar-slot-top"><a href="#" target="_blank"><img src="/img/qrcode/gzh.png" alt="npm" class="no-zoom" style="width: 100%;border-radius: 2px;"></a></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>s3 备份记录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/dee2c6/#安装aws-cli" class="sidebar-link">安装aws cli</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/dee2c6/#windows下安装" class="sidebar-link">windows下安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/dee2c6/#首先检查现有python版本" class="sidebar-link">首先检查现有python版本</a></li><li class="sidebar-sub-header level4"><a href="/pages/dee2c6/#安装python-pip-安装aws-cli" class="sidebar-link">安装python pip 安装aws cli</a></li><li class="sidebar-sub-header level4"><a href="/pages/dee2c6/#下载及安装-msi-installer" class="sidebar-link">下载及安装 MSI installer</a></li><li class="sidebar-sub-header level3"><a href="/pages/dee2c6/#linux下安装" class="sidebar-link">linux下安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/dee2c6/#检查安装python" class="sidebar-link">检查安装python</a></li><li class="sidebar-sub-header level4"><a href="/pages/dee2c6/#从pip安装awscli" class="sidebar-link">从pip安装awscli</a></li><li class="sidebar-sub-header level3"><a href="/pages/dee2c6/#配置awscli" class="sidebar-link">配置awscli</a></li><li class="sidebar-sub-header level3"><a href="/pages/dee2c6/#shell-脚本备份mysql并上传到s3" class="sidebar-link">shell 脚本备份mysql并上传到s3</a></li><li class="sidebar-sub-header level3"><a href="/pages/dee2c6/#下载安装-cron" class="sidebar-link">下载安装 cron</a></li></ul></li><li><a href="/pages/dee2c6/#这样就完成了定时备份mysql到s3" class="sidebar-link">这样就完成了定时备份mysql到s3</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dee2c6/#扩展" class="sidebar-link">扩展</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/posts/#随笔" data-v-06225672>随笔</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/trhsy" target="_blank" title="作者" class="beLink" data-v-06225672>trhsy</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2019年8月20日09:32:27</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">s3 备份记录<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="关于aws-s3-数据库备份记录"><a href="#关于aws-s3-数据库备份记录" class="header-anchor">#</a> 关于aws s3 数据库备份记录</h1> <p>最近需要使用mysql备份数据库，防止突发情况。
传统的备份一般都是直接备份到本机，或者其他地方，但是都是有点欠妥。比如那天服务器挂掉了，起不来了，传统数据库备份没有卵用。找了很多个备份服务器的，阿里云，腾讯云，亚马逊。为啥选择亚马逊，一是工作需要，而是真的很安全，阿里腾讯外围端口是全部开放的，亚马逊则是你开那个才有默认是全部关闭的。</p> <h2 id="安装aws-cli"><a href="#安装aws-cli" class="header-anchor">#</a> 安装aws cli</h2> <h3 id="windows下安装"><a href="#windows下安装" class="header-anchor">#</a> windows下安装</h3> <p>本机使用的是win7</p> <h4 id="首先检查现有python版本"><a href="#首先检查现有python版本" class="header-anchor">#</a> 首先检查现有python版本</h4> <p>快捷键<code>win+R</code>,输入<code>cmd</code>确定；打开cmd命令行输入<code>python -V</code> <img src="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/aws-pythin-v.png" alt="aws-pythin-v.png">
若小于2.7.9，请自行更新pythonb版本，cli官网上瞄到一眼说最低支持版本2.7.9，没研究之前版本会有什么问题，但是为了方便还是按要求来吧。</p> <h4 id="安装python-pip-安装aws-cli"><a href="#安装python-pip-安装aws-cli" class="header-anchor">#</a> 安装python pip 安装aws cli</h4> <p><a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">下载python<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,你可以下载最新的，但是等下安装pip的时候一定要根据安装的版本来。
安装完了之后需要配置环境变量，就是把你安装python的路径配置到path;具体操作，我的电脑-右键-属性-高级系统设置-环境变量-系统变量，找到path,编辑在最后填上<code>D:\Python27;D:\Python27\Scripts</code>这是我的，你可以替换成你的安装路径。
接着再次打开cmd输入<code>path</code>查看是否配置成功，再次检查python版本<code>python -V</code> <img src="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/aws-python.png" alt="aws-python.png">
python安装完毕后需要安装pip，下载地址：<a href="https://pypi.python.org/pypi/pip#downloads" target="_blank" rel="noopener noreferrer">https://pypi.python.org/pypi/pip#downloads<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
下载完成之后，解压到一个文件夹，用CMD控制台进入解压目录，输入
<code>python setup.py install</code>
正确安装完成之后需要加入path成为内部命令，将python目录下的scripts文件夹放入path中；就是上文中提到的环境配置。
输入<code>pip</code>测试是否正常
<img src="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/aws-pip.png" alt="aws-pip">
接着使用pip 安装awscli
输入<code>pip install awscli</code> 等待安装完毕；输入<code>aws --version</code> <img src="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/aws-v.png" alt="aws-v"></p> <h4 id="下载及安装-msi-installer"><a href="#下载及安装-msi-installer" class="header-anchor">#</a> 下载及安装 MSI installer</h4> <p><a href="https://s3.amazonaws.com/aws-cli/AWSCLI64.msi" target="_blank" rel="noopener noreferrer">https://s3.amazonaws.com/aws-cli/AWSCLI64.msi<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
下载后直接运行，一路下一步（如果想更改安装位置的话，可以手动修改）
安装完成cmd输入<code>aws --version</code> <img src="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/aws-v.png" alt="aws-v"></p> <h3 id="linux下安装"><a href="#linux下安装" class="header-anchor">#</a> linux下安装</h3> <p>本机使用 linux ubuntu</p> <h4 id="检查安装python"><a href="#检查安装python" class="header-anchor">#</a> 检查安装python</h4> <p>查看当前版本，我这个是更新过的，原来的版本2.7.4有点低，达不到要求害老夫一顿好整，哎</p> <div class="language-linux extra-class"><pre class="language-text"><code>root@fyb:~t# python -V
Python 3.4.3
</code></pre></div><p>还原一下原本的更新过程：</p> <div class="language-xml extra-class"><pre class="language-xml"><code># 查看现有python版本
python -V
# 若小于2.7.9,卸载当前版本
apt-get remove --auto-remove python
#更新源
sudo apt-get update
# 指定当前安装版本
sudo add-apt-repository ppa:jonathonf/python-3.6
# 安装python
sudo apt-get install python3.6
# 安装pip
sudo apt-get install python3-pip
# 更新pip
sudo pip install --upgrade pip
</code></pre></div><p>中间可能会出现一点问题，具体什么问题遇到找度娘，老夫这里不能重现了，已经折腾了一次了不想再被搞一次。</p> <h4 id="从pip安装awscli"><a href="#从pip安装awscli" class="header-anchor">#</a> 从pip安装awscli</h4> <p>输入<code>pip install awscli</code>，等待安装完成查看版本<code>aws --version</code></p> <h3 id="配置awscli"><a href="#配置awscli" class="header-anchor">#</a> 配置awscli</h3> <p>通过aws configure命令来进行配置
至少提供访问密钥ID和秘密访问密钥，这将使用你的帐户创建一个带有~/.aws的文件夹（windows下应该在<code>C:\Users\Administrator\.aws</code>）</p> <div class="language-xml extra-class"><pre class="language-xml"><code> aws configure
 Access key ID:your_key_ID
 Secret access key:your_access_key
 Default region name:your_region_name
 Default output format:可忽略(默认json)
</code></pre></div><p>aws cli常用命令</p> <div class="language-cli extra-class"><pre class="language-text"><code> # 创建桶
 aws s3 mb s3://your_aws_name
 # 查看桶
 aws s3 ls
 # 查看桶信息
 aws s3 ls s3://your_aws_name
 # 删除桶
 aws s3 rb s3://your_aws_name
 # 本地上传s3服务器
 aws s3 cp file.xml s3://your_aws_name
 # s3服务器下载本地
 aws s3 cp s3://your_aws_name ./

</code></pre></div><h3 id="shell-脚本备份mysql并上传到s3"><a href="#shell-脚本备份mysql并上传到s3" class="header-anchor">#</a> shell 脚本备份mysql并上传到s3</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># this mysql backups</span>

<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB_USER</span><span class="token operator">=</span><span class="token string">&quot;you-db-user&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;you-db-password&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB_HOST</span><span class="token operator">=</span><span class="token string">&quot;you-host&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">date_format</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +%a<span class="token variable">`</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">db_dir</span><span class="token operator">=</span><span class="token string">&quot;/usr/local/fyb_test/<span class="token variable">$date_format</span>&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">dest_backup_file</span><span class="token operator">=</span><span class="token string">&quot;/usr/local/fyb_test/<span class="token variable">$date_format</span>/mysql-databases-<span class="token variable">$date_format</span>.tgz&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">s3_bucket</span><span class="token operator">=</span><span class="token string">&quot;s3://your——name/&quot;</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$db_dir</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$db_dir</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
<span class="token comment"># If db_dir does not exist, create it：</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token variable">$db_dir</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$db_dir</span>
<span class="token keyword">fi</span>
<span class="token comment"># 将数据库转储到文件中</span>
<span class="token comment"># Get all MySQL databases</span>
mysqldump <span class="token parameter variable">-u</span> <span class="token variable">$DB_USER</span> <span class="token parameter variable">-h</span> <span class="token variable">$DB_HOST</span> -p<span class="token variable">$DB_PASSWORD</span> --no-create-db <span class="token parameter variable">--databases</span> wifidb <span class="token operator">&gt;</span> <span class="token variable">$db_dir</span>/wifidb-<span class="token variable">$date_format</span>.sql
<span class="token function">tar</span> <span class="token parameter variable">-zcvf</span> <span class="token variable">$dest_backup_file</span> <span class="token parameter variable">-C</span> <span class="token variable">$db_dir</span> <span class="token builtin class-name">.</span>
<span class="token comment">#压缩文件传到s3</span>
aws s3 <span class="token function">cp</span> <span class="token variable">$dest_backup_file</span> <span class="token variable">${s3_bucket}</span>
aws s3 <span class="token function">ls</span> <span class="token variable">${s3_bucket}</span>

</code></pre></div><p>新建一个文件修改名字为<code>mysql_backups.sh</code>,上传到linux服务器，设置定时任务每天备份或者其他时间</p> <h3 id="下载安装-cron"><a href="#下载安装-cron" class="header-anchor">#</a> 下载安装 cron</h3> <p>linux下执行命令<code>sudo apt-get install cron</code>
corn 使用简要说明</p> <div class="language- extra-class"><pre class="language-text"><code> # 启动状态
 service cron status
 # 启动
 service cron start
 # 关闭
 service cron stop
 
 # 查看当前任务计划
 crontab –l
 # 编辑
 crontab -e
 # 移除
 crontab –r
 -u user：用来设定某个用户的crontab服务；
 file：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab。
 如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab。
 -e：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。
 -l：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。
 -r：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。
 -i：在删除用户的crontab文件时给确认提示。
</code></pre></div><p>切换到安装路径<code>cd /var/spool/cron</code>
设置定时任务<code>crontab -e</code></p> <div class="language-xml extra-class"><pre class="language-xml"><code>HELL=/bin/sh
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=you-email@163.com

0 0 * * * /you-path/mysql_backups.sh

# Example of job definition:
# .---------------- minute (0 - 59)
# | .------------- hour (0 - 23)
# | | .---------- day of month (1 - 31)
# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...
# | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# | | | | |
# * * * * * user-name command to be executed
</code></pre></div><h2 id="这样就完成了定时备份mysql到s3"><a href="#这样就完成了定时备份mysql到s3" class="header-anchor">#</a> 这样就完成了定时备份mysql到s3</h2> <h2 id="扩展"><a href="#扩展" class="header-anchor">#</a> 扩展</h2> <p>从s3 上下载下来并还原到数据库</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># this mysql download</span>

<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB_USER</span><span class="token operator">=</span><span class="token string">&quot;you-user&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;you-password&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DB</span><span class="token operator">=</span><span class="token string">&quot;you-db&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">date_format</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +%a<span class="token variable">`</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">db_dir</span><span class="token operator">=</span><span class="token string">&quot;/usr/local/fyb_test/download/<span class="token variable">$date_format</span>&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">s3_bucket</span><span class="token operator">=</span><span class="token string">&quot;s3://you-name/mysql-databases-<span class="token variable">$date_format</span>.tgz&quot;</span>
<span class="token comment"># rm -rf $db_dir</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$db_dir</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null
<span class="token comment"># If db_dir does not exist, create it：</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token variable">$db_dir</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$db_dir</span>
<span class="token keyword">fi</span>
<span class="token comment">#查看 s3目录</span>
aws s3 <span class="token function">ls</span> <span class="token variable">${s3_bucket}</span>
<span class="token comment"># aws s3 cp ${s3_bucket} $db_dir</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$db_dir</span>
<span class="token function">ls</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token variable">$db_dir</span>/mysql-databases-<span class="token variable">$date_format</span>.tgz <span class="token builtin class-name">.</span>
<span class="token function">ls</span>
<span class="token builtin class-name">cd</span> /usr/sbin
mysql <span class="token parameter variable">-u</span> <span class="token variable">$DB_USER</span> -p<span class="token variable">$DB_PASSWORD</span> --default-character-set<span class="token operator">=</span>utf8 <span class="token variable">$DB</span> <span class="token operator">&lt;</span><span class="token variable">$db_dir</span>/wifidb-<span class="token variable">$date_format</span>.sql

</code></pre></div><p>新建文件命名为<code>s3-mysql-download.sh</code>,需要还原的时候直接执行文件即可。</p> <p>如果本文对您有所帮助，请打赏给我吧，我先送个你也红包往下看，你可以把扫到红包打赏个我哦！
<img src="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/hb.jpg" alt="红包"></p></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/12/05, 09:12:57</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:trhsy_fan@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/trhsy" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://cdn.jsdelivr.net/gh/trhsy/PicGo/img/关注微信公众号获取更多资讯.jpg" title="公众号" target="_blank" class="iconfont icon-weixin"></a><a href="https://qun.qq.com/qqweb/qunpro/share?_wv=3&amp;_wwv=128&amp;appChannel=share&amp;inviteCode=1W9y5py&amp;businessType=9&amp;from=246610&amp;biz=ka" title="QQ群" target="_blank" class="iconfont icon-QQ"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2025
    <span>Sim-U | By Trhsy</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.31fb423f.js" defer></script><script src="/assets/js/2.bbf0c30b.js" defer></script><script src="/assets/js/20.9148d42d.js" defer></script>
  </body>
</html>
